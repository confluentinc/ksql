{
  "tests": [
    {
      "name": "project and filter",
      "statements": [
        "CREATE STREAM TEST (ID bigint, NAME varchar, VALUE double) WITH (kafka_topic='test_topic', value_format='DELIMITED', key='ID');",
        "CREATE STREAM S1 as SELECT name FROM test where id > 100;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": 0, "value": "0,zero,0.0", "timestamp": 0},
        {"topic": "test_topic", "key": 100, "value": "100,100,0.0", "timestamp": 0},
        {"topic": "test_topic", "key": 101, "value": "101,101,0.0", "timestamp": 0}
      ],
      "outputs": [
        {"topic": "S1", "key": 101, "value": "101", "timestamp": 0}
      ]
    },
    {
      "name": "count",
      "statements": [
        "CREATE STREAM TEST (ID bigint, NAME varchar, VALUE double) WITH (kafka_topic='test_topic', value_format='DELIMITED', key='ID');",
        "CREATE STREAM S2 as SELECT id, count(*) FROM test group by id;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": 0, "value": "0,zero,0.0", "timestamp": 0},
        {"topic": "test_topic", "key": 0, "value": "0,100,0.0", "timestamp": 0},
        {"topic": "test_topic", "key": 100, "value": "100,100,0.0", "timestamp": 0}
      ],
      "outputs": [
        {"topic": "S2", "key": 0, "value": "0,1", "timestamp": 0},
        {"topic": "S2", "key": 0, "value": "0,2", "timestamp": 0},
        {"topic": "S2", "key": 100, "value": "100,1", "timestamp": 0}
      ]
    },
    {
      "name": "sum",
      "statements": [
        "CREATE STREAM TEST (ID bigint, NAME varchar, VALUE double) WITH (kafka_topic='test_topic', value_format='DELIMITED', key='ID');",
        "CREATE STREAM S2 as SELECT id, sum(id) FROM test group by id;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": 0, "value": "0,zero,0.0", "timestamp": 0},
        {"topic": "test_topic", "key": 0, "value": "0,100,0.0", "timestamp": 0},
        {"topic": "test_topic", "key": 100, "value": "100,100,0.0", "timestamp": 0},
        {"topic": "test_topic", "key": 100, "value": "100,100,0.0", "timestamp": 0}
      ],
      "outputs": [
        {"topic": "S2", "key": 0, "value": "0,0", "timestamp": 0},
        {"topic": "S2", "key": 0, "value": "0,0", "timestamp": 0},
        {"topic": "S2", "key": 100, "value": "100,100", "timestamp": 0},
        {"topic": "S2", "key": 100, "value": "100,200", "timestamp": 0}
      ]
    }

  ]

}