{
  "tests": [
    {
      "name": "geo distance",
      "statements": [
        "CREATE STREAM TEST (ID bigint, LAT1 double, LON1, double, LAT2, double, LON2 double, RADIUS varchar) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM DISTANCE_STREAM AS select ID, geodistance(LAT1, LON1, LAT2, LON2, RADIUS) as CALCULATED_DISTANCE from test;"
      ],
      "inputs": [
        {"topic": "test_topic", "value": {"ID": 2, "LAT1": 37.4439, "LON1": -122.1663, "LAT2": 51.5257, "LON2": -0.1122}, "RADIUS": "KM"},
        {"topic": "test_topic", "value": {"ID": 3, "LAT1": 37.4439, "LON1": -122.1663, "LAT2": 51.5257, "LON2": -0.1122}, "RADIUS": "MI"},
        {"topic": "test_topic", "value": {"ID": 4, "LAT1": 51.5257, "LON1": -0.1122, "LAT2": -33.9323, "LON2": 18.4197}},
        {"topic": "test_topic", "value": {"ID": 5, "LAT1": 51.5257, "LON1": -0.1122, "LAT2": -33.9323, "LON2": 18.4197}, "RADIUS": "KM"},
        {"topic": "test_topic", "value": {"ID": 6, "LAT1": 51.5257, "LON1": -0.1122, "LAT2": -33.9323, "LON2": 18.4197}, "RADIUS": "MI"},
        {"topic": "test_topic", "value": {"ID": 7, "LAT1": -33.9323, "LON1": 18.4197, "LAT2": -33.8666, "LON2": 151.1}},
        {"topic": "test_topic", "value": {"ID": 8, "LAT1": -33.9323, "LON1": 18.4197, "LAT2": -33.8666, "LON2": 151.1}, "RADIUS": "KM"},
        {"topic": "test_topic", "value": {"ID": 9, "LAT1": -33.9323, "LON1": 18.4197, "LAT2": -33.8666, "LON2": 151.1}, "RADIUS": "MI"}
      ],
      "outputs": [
        {"topic": "DISTANCE_STREAM", "value": {"ID": 1, "CALCULATED_DISTANCE": 8634.6528}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 2, "CALCULATED_DISTANCE": 8634.6528}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 3, "CALCULATED_DISTANCE": 5365.66}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 4, "CALCULATED_DISTANCE": 9673.4042}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 5, "CALCULATED_DISTANCE": 9673.4042}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 6, "CALCULATED_DISTANCE": 6011.1453}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 7, "CALCULATED_DISTANCE": 11005.2330}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 8, "CALCULATED_DISTANCE": 11005.2330}},
        {"topic": "DISTANCE_STREAM", "value": {"ID": 9, "CALCULATED_DISTANCE": 6838.7564}}
      ]
    }
  ]
}


