{
  "comments": [
    "Test cases covering the different schemas supported."
  ],
  "tests": [
    {
      "name": "top level primitive - value",
      "format": ["JSON", "AVRO"],
      "statements": [
        "CREATE STREAM INPUT (foo INT) WITH (kafka_topic='input_topic', value_format='{FORMAT}');",
        "CREATE STREAM OUTPUT AS SELECT * FROM INPUT;"
      ],
      "topics": [
        {
          "name": "input_topic",
          "schema": {"type": "int"},
          "format": "{FORMAT}"
        }
      ],
      "inputs": [
        {"topic": "input_topic", "value": 10}
      ],
      "outputs": [
        {"topic": "OUTPUT", "value": {"FOO": 10}}
      ]
    },
    {
      "name": "coerce top level primitive - value",
      "format": ["JSON", "AVRO"],
      "statements": [
        "CREATE STREAM INPUT (foo STRING) WITH (kafka_topic='input_topic', value_format='{FORMAT}');",
        "CREATE STREAM OUTPUT AS SELECT * FROM INPUT;"
      ],
      "topics": [
        {
          "name": "input_topic",
          "schema": {"type": "int"},
          "format": "{FORMAT}"
        }
      ],
      "inputs": [
        {"topic": "input_topic", "value": 10}
      ],
      "outputs": [
        {"topic": "OUTPUT", "value": {"FOO": "10"}}
      ]
    },
    {
      "name": "top level array - value",
      "comments": [
        "see github issue https://github.com/confluentinc/ksql/issues/1351"
      ],
      "format": ["JSON", "AVRO"],
      "statements": [
        "CREATE STREAM INPUT (foo ARRAY<STRING>) WITH (kafka_topic='input_topic', value_format='{FORMAT}');",
        "CREATE STREAM OUTPUT AS SELECT * FROM INPUT;"
      ],
      "topics": [
        {
          "name": "input_topic",
          "schema": {"type": "array", "items": {"type": "string"}},
          "format": "{FORMAT}"
        }
      ],
      "inputs": [
        {"topic": "input_topic", "value": ["a", "b", "c"]}
      ],
      "outputs": [
        {"topic": "OUTPUT", "value": {"FOO": ["a", "b", "c"]}}
      ]
    },
    {
      "name": "coerce top level array - value",
      "format": ["JSON", "AVRO"],
      "statements": [
        "CREATE STREAM INPUT (foo ARRAY<STRING>) WITH (kafka_topic='input_topic', value_format='{FORMAT}');",
        "CREATE STREAM OUTPUT AS SELECT * FROM INPUT;"
      ],
      "topics": [
        {
          "name": "input_topic",
          "schema": {"type": "array", "items": {"type": "string"}},
          "format": "{FORMAT}"
        }
      ],
      "inputs": [
        {"topic": "input_topic", "value": [1, 2, 3]}
      ],
      "outputs": [
        {"topic": "OUTPUT", "value": {"FOO": ["1", "2", "3"]}}
      ]
    }
  ]
}