{
  "comments": [
    "Tests covering SUBLIST functionality with generics"
  ],
  "tests": [
    {
      "name": "sublist for string list",
      "statements": [
        "CREATE STREAM TEST (l ARRAY<VARCHAR>) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM OUTPUT AS SELECT SUBLIST(l, 1, 3) as sub FROM TEST;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": 1, "value": {"l": ["a", "b", "c", "d"]}, "timestamp": 0}
      ],
      "outputs": [
        {"topic": "OUTPUT", "key": 1, "value": {"SUB":["b", "c"]}, "timestamp": 0}
      ]
    },
    {
      "name": "sublist for list of lists",
      "statements": [
        "CREATE STREAM TEST (l ARRAY<ARRAY<VARCHAR>>) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM OUTPUT AS SELECT SUBLIST(l, 1, 3) as sub FROM TEST;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": 1, "value": {"l": [["a"], ["b"], ["c"], ["d"]]}, "timestamp": 0}
      ],
      "outputs": [
        {"topic": "OUTPUT", "key": 1, "value": {"SUB":[["b"], ["c"]]}, "timestamp": 0}
      ]
    },
    {
      "name": "sublist for list of maps",
      "statements": [
        "CREATE STREAM TEST (l ARRAY<MAP<VARCHAR, VARCHAR>>) WITH (kafka_topic='test_topic', value_format='JSON');",
        "CREATE STREAM OUTPUT AS SELECT SUBLIST(l, 1, 3) as sub FROM TEST;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": 1, "value": {"l": [{"a": "1"}, {"b": "2"}, {"c": "3"}, {"d": "4"}]}, "timestamp": 0}
      ],
      "outputs": [
        {"topic": "OUTPUT", "key": 1, "value": {"SUB":[{"b": "2"}, {"c": "3"}]}, "timestamp": 0}
      ]
    }
  ]
}