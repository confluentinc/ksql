{
  "comments": [
    "Tests covering the use of the CONVERT_TZ function."
  ],
  "tests": [
    {
      "name": "convert timezones defined by offset",
      "statements": [
        "CREATE STREAM TEST (K STRING KEY, ts TIMESTAMP, t TIME) WITH (kafka_topic='test_topic', value_format='DELIMITED');",
        "CREATE STREAM TS AS select K, convert_tz(ts, '+0200', '+0500') as ts, convert_tz(t, '+0200', '+0500') as t from test;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": "0", "value": "100,100"},
        {"topic": "test_topic", "key": "0", "value": "1589234313000,86399000"},
        {"topic": "test_topic", "key": "0", "value": null}
      ],
      "outputs": [
        {"topic": "TS", "key": "0", "value": "10800100,10800100"},
        {"topic": "TS", "key": "0", "value": "1589245113000,10799000"},
        {"topic": "TS", "key": "0", "value": null}
      ]
    },
    {
      "name": "convert timezones defined by name",
      "statements": [
        "CREATE STREAM TEST (K STRING KEY, ts TIMESTAMP, t TIME) WITH (kafka_topic='test_topic', value_format='DELIMITED');",
        "CREATE STREAM TS AS select K, convert_tz(ts, 'America/Los_Angeles', 'America/New_York') as ts, convert_tz(t, 'America/Los_Angeles', 'America/New_York') as t from test;"
      ],
      "inputs": [
        {"topic": "test_topic", "key": "0", "value": "100,100"},
        {"topic": "test_topic", "key": "0", "value": "1589234313000,86399000"},
        {"topic": "test_topic", "key": "0", "value": null}
      ],
      "outputs": [
        {"topic": "TS", "key": "0", "value": "10800100,10800100"},
        {"topic": "TS", "key": "0", "value": "1589245113000,10799000"},
        {"topic": "TS", "key": "0", "value": null}
      ]
    }
  ]
}