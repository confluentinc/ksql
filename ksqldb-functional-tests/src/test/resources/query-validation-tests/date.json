{
  "comments": ["tests for date functionality"],
  "tests": [
    {
      "name": "DELIMITED in/out",
      "statements": [
        "CREATE STREAM TEST (ID STRING KEY, date DATE) WITH (kafka_topic='test', value_format='DELIMITED');",
        "CREATE STREAM TEST2 AS SELECT * FROM TEST;"
      ],
      "inputs": [
        {"topic": "test", "value": "10"},
        {"topic": "test", "value": "-10"}
      ],
      "outputs": [
        {"topic": "TEST2", "value": "10"},
        {"topic": "TEST2", "value": "\"-10\""}
      ]
    },
    {
      "name": "AVRO in/out",
      "statements": [
        "CREATE STREAM TEST (ID STRING KEY, date DATE) WITH (kafka_topic='test', value_format='AVRO');",
        "CREATE STREAM TEST2 AS SELECT * FROM TEST;"
      ],
      "inputs": [
        {"topic": "test", "value": {"DATE": 10}},
        {"topic": "test", "value": {"DATE": -10}}
      ],
      "outputs": [
        {"topic": "TEST2", "value": {"DATE": 10}},
        {"topic": "TEST2", "value": {"DATE": -10}}
      ]
    },
    {
      "name": "JSON in/out",
      "statements": [
        "CREATE STREAM TEST (ID STRING KEY, date DATE) WITH (kafka_topic='test', value_format='JSON');",
        "CREATE STREAM TEST2 AS SELECT * FROM TEST;"
      ],
      "inputs": [
        {"topic": "test", "value": {"date": 10}},
        {"topic": "test", "value": {"date": -10}}
      ],
      "outputs": [
        {"topic": "TEST2", "value": {"DATE": 10}},
        {"topic": "TEST2", "value": {"DATE": -10}}
      ]
    },
    {
      "name": "PROTOBUF in/out",
      "statements": [
        "CREATE STREAM TEST (ID STRING KEY, date DATE) WITH (kafka_topic='test', value_format='PROTOBUF');",
        "CREATE STREAM TEST2 AS SELECT * FROM TEST;"
      ],
      "inputs": [
        {"topic": "test", "value": {"date": 10}},
        {"topic": "test", "value": {"date": -10}}
      ],
      "outputs": [
        {"topic": "TEST2", "value": {"DATE": 10}},
        {"topic": "TEST2", "value": {"DATE": -10}}
      ]
    }
  ]
}