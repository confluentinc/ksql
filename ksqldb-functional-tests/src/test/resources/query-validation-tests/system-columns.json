{
  "comments": [
    "Test covering the generic use of system column names"
  ],
  "tests": [
    {
      "name": "should fail if ROWKEY used as key column name",
      "statements": [
        "CREATE STREAM INPUT (ROWKEY int) WITH (kafka_topic='test', value_format='JSON');"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.util.KsqlStatementException",
        "message": "'ROWKEY' is a reserved column name. It can only be used for KEY columns."
      }
    },
    {
      "name": "should fail if ROWKEY used as value column name",
      "statements": [
        "CREATE STREAM INPUT (x int) WITH (kafka_topic='test', value_format='JSON');",
        "CREATE STREAM OUTPUT AS SELECT x AS rowkey FROM INPUT;"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.util.KsqlStatementException",
        "message": "Value column name(s) `ROWKEY` clashes with key column name(s)."
      }
    },
    {
      "name": "should fail if ROWTIME used as column name",
      "statements": [
        "CREATE STREAM INPUT (x int) WITH (kafka_topic='test', value_format='JSON');",
        "CREATE STREAM OUTPUT AS SELECT x AS rowtime FROM INPUT;"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.parser.exception.ParseFailedException",
        "message": "ROWTIME is a reserved system column name. You cannot use it as an alias for a column."
      }
    },
    {
      "name": "should fail if WINDOWSTART used as column name",
      "statements": [
        "CREATE STREAM INPUT (x int) WITH (kafka_topic='test', value_format='JSON', WINDOW_TYPE='session');",
        "CREATE STREAM OUTPUT AS SELECT x AS windowstart FROM INPUT;"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.parser.exception.ParseFailedException",
        "message": "WINDOWSTART is a reserved system column name. You cannot use it as an alias for a column."
      }
    },
    {
      "name": "should fail if WINDOWEND used as column name",
      "statements": [
        "CREATE STREAM INPUT (x int) WITH (kafka_topic='test', value_format='JSON', WINDOW_TYPE='session');",
        "CREATE STREAM OUTPUT AS SELECT x AS windowend FROM INPUT;"
      ],
      "expectedException": {
        "type": "io.confluent.ksql.parser.exception.ParseFailedException",
        "message": "WINDOWEND is a reserved system column name. You cannot use it as an alias for a column."
      }
    }
  ]
}