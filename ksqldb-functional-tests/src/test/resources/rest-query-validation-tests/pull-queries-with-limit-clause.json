{
  "comments": [
    "Pull Query tests covering the use of LIMIT clause."
  ],
  "tests": [
    {
      "name": "on stream",
      "format": ["JSON"],
      "statements": [
        "CREATE STREAM riderLocations (profileId VARCHAR, latitude DOUBLE, longitude DOUBLE) WITH (kafka_topic='test_topic', value_format='{FORMAT}');",
        "SELECT * FROM riderLocations LIMIT 8;",
        "SELECT * FROM riderLocations LIMIT 0;",
        "SELECT * FROM riderLocations LIMIT 25;"
      ],
      "topics": [
        {"name": "test_topic", "partitions": 1} // to get a stable ordering
      ],
      "inputs": [
        {"topic": "test_topic", "timestamp": 1000001, "value": {"profileId": "which", "latitude": 37.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000002, "value": {"profileId": "there", "latitude": 37.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000003, "value": {"profileId": "their", "latitude": 37.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000004, "value": {"profileId": "about", "latitude": 37.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000005, "value": {"profileId": "would", "latitude": 37.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000006, "value": {"profileId": "these", "latitude": 37.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000007, "value": {"profileId": "other", "latitude": 38.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000008, "value": {"profileId": "words", "latitude": 38.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000009, "value": {"profileId": "could", "latitude": 38.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000010, "value": {"profileId": "write", "latitude": 38.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000011, "value": {"profileId": "first", "latitude": 38.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000012, "value": {"profileId": "water", "latitude": 38.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000013, "value": {"profileId": "after", "latitude": 37.7877, "longitude": -123.4205}},
        {"topic": "test_topic", "timestamp": 1000014, "value": {"profileId": "where", "latitude": 37.3903, "longitude": -123.0643}},
        {"topic": "test_topic", "timestamp": 1000015, "value": {"profileId": "right", "latitude": 37.3952, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000016, "value": {"profileId": "think", "latitude": 37.3944, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000017, "value": {"profileId": "three", "latitude": 37.4049, "longitude": -123.0822}},
        {"topic": "test_topic", "timestamp": 1000018, "value": {"profileId": "years", "latitude": 37.7857, "longitude": -123.4011}}
      ],
      "responses": [
        {"admin": {"@type": "currentStatus"}},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}},
          {"row": {"columns": ["which", 37.7877, -122.4205]}},
          {"row": {"columns": ["there", 37.3903, -122.0643]}},
          {"row": {"columns": ["their", 37.3952, -122.0813]}},
          {"row": {"columns": ["about", 37.3944, -122.0813]}},
          {"row": {"columns": ["would", 37.4049, -122.0822]}},
          {"row": {"columns": ["these", 37.7857, -122.4011]}},
          {"row": {"columns": ["other", 38.7877, -122.4205]}},
          {"row": {"columns": ["words", 38.3903, -122.0643]}},
          {"finalMessage":"Limit Reached"}
        ]},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}},
          {"finalMessage":"Limit Reached"}
        ]},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}},
          {"row":{"columns":["which",37.7877,-122.4205]}},
          {"row":{"columns":["there",37.3903,-122.0643]}},
          {"row":{"columns":["their",37.3952,-122.0813]}},
          {"row":{"columns":["about",37.3944,-122.0813]}},
          {"row":{"columns":["would",37.4049,-122.0822]}},
          {"row":{"columns":["these",37.7857,-122.4011]}},
          {"row":{"columns":["other",38.7877,-122.4205]}},
          {"row":{"columns":["words",38.3903,-122.0643]}},
          {"row":{"columns":["could",38.3952,-122.0813]}},
          {"row":{"columns":["write",38.3944,-122.0813]}},
          {"row":{"columns":["first",38.4049,-122.0822]}},
          {"row":{"columns":["water",38.7857,-122.4011]}},
          {"row":{"columns":["after",37.7877,-123.4205]}},
          {"row":{"columns":["where",37.3903,-123.0643]}},
          {"row":{"columns":["right",37.3952,-123.0813]}},
          {"row":{"columns":["think",37.3944,-123.0813]}},
          {"row":{"columns":["three",37.4049,-123.0822]}},
          {"row":{"columns":["years",37.7857,-123.4011]}}
        ]}
      ]
    },
    {
      "name": "on source table - all unique keys",
      "format": ["JSON", "PROTOBUF"],
      "statements": [
        "CREATE SOURCE TABLE riderLocations (profileId STRING PRIMARY KEY, latitude DOUBLE, longitude DOUBLE) WITH (kafka_topic='test_topic', value_format='{FORMAT}');",
        "SELECT * FROM riderLocations LIMIT 8;",
        "SELECT * FROM riderLocations LIMIT 0;",
        "SELECT * FROM riderLocations LIMIT 25;"
      ],
      "topics": [
        {"name": "test_topic", "partitions": 1} // to get a stable ordering
      ],
      "inputs": [
        {"topic": "test_topic", "timestamp": 1000001, "key": "which", "value": {"latitude": 37.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000002, "key": "there", "value": {"latitude": 37.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000003, "key": "their", "value": {"latitude": 37.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000004, "key": "about", "value": {"latitude": 37.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000005, "key": "would", "value": {"latitude": 37.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000006, "key": "these", "value": {"latitude": 37.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000007, "key": "other", "value": {"latitude": 38.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000008, "key": "words", "value": {"latitude": 38.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000009, "key": "could", "value": {"latitude": 38.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000010, "key": "write", "value": {"latitude": 38.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000011, "key": "first", "value": {"latitude": 38.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000012, "key": "water", "value": {"latitude": 38.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000013, "key": "after", "value": {"latitude": 37.7877, "longitude": -123.4205}},
        {"topic": "test_topic", "timestamp": 1000014, "key": "where", "value": {"latitude": 37.3903, "longitude": -123.0643}},
        {"topic": "test_topic", "timestamp": 1000015, "key": "right", "value": {"latitude": 37.3952, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000016, "key": "think", "value": {"latitude": 37.3944, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000017, "key": "three", "value": {"latitude": 37.4049, "longitude": -123.0822}},
        {"topic": "test_topic", "timestamp": 1000018, "key": "years", "value": {"latitude": 37.7857, "longitude": -123.4011}}
      ],
      "responses": [
        {"admin": {"@type": "currentStatus"}},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING KEY, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}},
          {"row":{"columns":["about",37.3944,-122.0813]}},
          {"row":{"columns":["after",37.7877,-123.4205]}},
          {"row":{"columns":["could",38.3952,-122.0813]}},
          {"row":{"columns":["first",38.4049,-122.0822]}},
          {"row":{"columns":["other",38.7877,-122.4205]}},
          {"row":{"columns":["right",37.3952,-123.0813]}},
          {"row":{"columns":["their",37.3952,-122.0813]}},
          {"row":{"columns":["there",37.3903,-122.0643]}}
        ]},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING KEY, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}}
        ]},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING KEY, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}},
          {"row":{"columns":["about",37.3944,-122.0813]}},
          {"row":{"columns":["after",37.7877,-123.4205]}},
          {"row":{"columns":["could",38.3952,-122.0813]}},
          {"row":{"columns":["first",38.4049,-122.0822]}},
          {"row":{"columns":["other",38.7877,-122.4205]}},
          {"row":{"columns":["right",37.3952,-123.0813]}},
          {"row":{"columns":["their",37.3952,-122.0813]}},
          {"row":{"columns":["there",37.3903,-122.0643]}},
          {"row":{"columns":["these",37.7857,-122.4011]}},
          {"row":{"columns":["think",37.3944,-123.0813]}},
          {"row":{"columns":["three",37.4049,-123.0822]}},
          {"row":{"columns":["water",38.7857,-122.4011]}},
          {"row":{"columns":["where",37.3903,-123.0643]}},
          {"row":{"columns":["which",37.7877,-122.4205]}},
          {"row":{"columns":["words",38.3903,-122.0643]}},
          {"row":{"columns":["would",37.4049,-122.0822]}},
          {"row":{"columns":["write",38.3944,-122.0813]}},
          {"row":{"columns":["years",37.7857,-123.4011]}}
        ]}
      ]
    },
    {
      "name": "on source table - repeated unique keys",
      "format": ["JSON", "PROTOBUF"],
      "statements": [
        "CREATE SOURCE TABLE riderLocations (profileId STRING PRIMARY KEY, latitude DOUBLE, longitude DOUBLE) WITH (kafka_topic='test_topic', value_format='{FORMAT}');",
        "SELECT * FROM riderLocations LIMIT 3;",
        "SELECT * FROM riderLocations;"
      ],
      "topics": [
        {"name": "test_topic", "partitions": 1} // to get a stable ordering
      ],
      "inputs": [
        {"topic": "test_topic", "timestamp": 1000001, "key": "which", "value": {"latitude": 37.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000002, "key": "there", "value": {"latitude": 37.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000003, "key": "their", "value": {"latitude": 37.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000004, "key": "about", "value": {"latitude": 37.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000005, "key": "would", "value": {"latitude": 37.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000006, "key": "these", "value": {"latitude": 37.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000007, "key": "other", "value": {"latitude": 38.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000008, "key": "which", "value": {"latitude": 38.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000009, "key": "there", "value": {"latitude": 38.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000010, "key": "their", "value": {"latitude": 38.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000011, "key": "about", "value": {"latitude": 38.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000012, "key": "would", "value": {"latitude": 38.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000013, "key": "these", "value": {"latitude": 37.7877, "longitude": -123.4205}},
        {"topic": "test_topic", "timestamp": 1000014, "key": "other", "value": {"latitude": 37.3903, "longitude": -123.0643}},
        {"topic": "test_topic", "timestamp": 1000015, "key": "which", "value": {"latitude": 37.3952, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000016, "key": "there", "value": {"latitude": 37.3944, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000017, "key": "their", "value": {"latitude": 37.4049, "longitude": -123.0822}},
        {"topic": "test_topic", "timestamp": 1000018, "key": "about", "value": {"latitude": 37.7857, "longitude": -123.4011}}
      ],
      "responses": [
        {"admin": {"@type": "currentStatus"}},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING KEY, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}},
          {"row":{"columns":["about",37.7857,-123.4011]}},
          {"row":{"columns":["other",37.3903,-123.0643]}},
          {"row":{"columns":["their",37.4049,-123.0822]}}
        ]},
        {"query": [
          {"header":{"schema":"`PROFILEID` STRING KEY, `LATITUDE` DOUBLE, `LONGITUDE` DOUBLE"}},
          {"row":{"columns":["about",37.7857,-123.4011]}},
          {"row":{"columns":["other",37.3903,-123.0643]}},
          {"row":{"columns":["their",37.4049,-123.0822]}},
          {"row":{"columns":["there",37.3944,-123.0813]}},
          {"row":{"columns":["these",37.7877,-123.4205]}},
          {"row":{"columns":["which",37.3952,-123.0813]}},
          {"row":{"columns":["would",38.7857,-122.4011]}}
        ]}
      ]
    },
    {
      "name": "on CTAS",
      "format": ["JSON", "PROTOBUF"],
      "statements": [
        "CREATE TABLE riderLocations (profileId STRING PRIMARY KEY, latitude DOUBLE, longitude DOUBLE) WITH (kafka_topic='test_topic', value_format='{FORMAT}');",
        "CREATE TABLE ridersNearMountainView AS SELECT ROUND(GEO_DISTANCE(latitude, longitude, 37.4133, -122.1162), -1) AS distanceInMiles, COLLECT_LIST(profileId) AS riders, COUNT(*) AS count FROM riderLocations GROUP BY ROUND(GEO_DISTANCE(latitude, longitude, 37.4133, -122.1162), -1);",
        "SELECT * FROM ridersNearMountainView;",
        "SELECT * FROM ridersNearMountainView LIMIT 4;",
        "SELECT * FROM ridersNearMountainView LIMIT 0;",
        "SELECT * FROM ridersNearMountainView LIMIT 25;"
      ],
      "topics": [
        {"name": "test_topic", "partitions": 1} // to get a stable ordering
      ],
      "inputs": [
        {"topic": "test_topic", "timestamp": 1000001, "key": "which", "value": {"latitude": 37.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000002, "key": "there", "value": {"latitude": 37.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000003, "key": "their", "value": {"latitude": 37.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000004, "key": "about", "value": {"latitude": 37.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000005, "key": "would", "value": {"latitude": 37.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000006, "key": "these", "value": {"latitude": 37.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000007, "key": "other", "value": {"latitude": 38.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000008, "key": "words", "value": {"latitude": 38.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000009, "key": "could", "value": {"latitude": 38.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000010, "key": "write", "value": {"latitude": 38.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000011, "key": "first", "value": {"latitude": 38.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000012, "key": "water", "value": {"latitude": 38.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000013, "key": "after", "value": {"latitude": 37.7877, "longitude": -123.4205}},
        {"topic": "test_topic", "timestamp": 1000014, "key": "where", "value": {"latitude": 37.3903, "longitude": -123.0643}},
        {"topic": "test_topic", "timestamp": 1000015, "key": "right", "value": {"latitude": 37.3952, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000016, "key": "think", "value": {"latitude": 37.3944, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000017, "key": "three", "value": {"latitude": 37.4049, "longitude": -123.0822}},
        {"topic": "test_topic", "timestamp": 1000018, "key": "years", "value": {"latitude": 37.7857, "longitude": -123.4011}}
      ],
      "responses": [
        {"admin": {"@type": "currentStatus"}},
        {"admin": {"@type": "currentStatus"}},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [0.0  , ["their", "about", "would"]         , 3]}},
          {"row": {"columns": [10.0 , ["there"]                           , 1]}},
          {"row": {"columns": [50.0 , ["which", "these"]                  , 2]}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}},
          {"row": {"columns": [90.0 , ["right", "think", "three"]         , 3]}},
          {"row": {"columns": [110.0, ["words", "could", "write", "first"], 4]}},
          {"row": {"columns": [120.0, ["after", "years"]                  , 2]}},
          {"row": {"columns": [150.0, ["water"]                           , 1]}},
          {"row": {"columns": [160.0, ["other"]                           , 1]}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [0.0  , ["their", "about", "would"]         , 3]}},
          {"row": {"columns": [10.0 , ["there"]                           , 1]}},
          {"row": {"columns": [50.0 , ["which", "these"]                  , 2]}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [0.0  , ["their", "about", "would"]         , 3]}},
          {"row": {"columns": [10.0 , ["there"]                           , 1]}},
          {"row": {"columns": [50.0 , ["which", "these"]                  , 2]}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}},
          {"row": {"columns": [90.0 , ["right", "think", "three"]         , 3]}},
          {"row": {"columns": [110.0, ["words", "could", "write", "first"], 4]}},
          {"row": {"columns": [120.0, ["after", "years"]                  , 2]}},
          {"row": {"columns": [150.0, ["water"]                           , 1]}},
          {"row": {"columns": [160.0, ["other"]                           , 1]}}
        ]}
      ]
    },
    {
      "name": "on CTAS range scan",
      "format": ["JSON", "PROTOBUF"],
      "statements": [
        "CREATE TABLE riderLocations (profileId STRING PRIMARY KEY, latitude DOUBLE, longitude DOUBLE) WITH (kafka_topic='test_topic', value_format='{FORMAT}');",
        "CREATE TABLE ridersNearMountainView AS SELECT ROUND(GEO_DISTANCE(latitude, longitude, 37.4133, -122.1162), -1) AS distanceInMiles, COLLECT_LIST(profileId) AS riders, COUNT(*) AS count FROM riderLocations GROUP BY ROUND(GEO_DISTANCE(latitude, longitude, 37.4133, -122.1162), -1);",
        "SELECT * FROM ridersNearMountainView WHERE DISTANCEINMILES > 70;",
        "SELECT * FROM ridersNearMountainView WHERE DISTANCEINMILES < 100;",
        "SELECT * FROM ridersNearMountainView WHERE DISTANCEINMILES > 70 AND DISTANCEINMILES < 140;",
        "SELECT * FROM ridersNearMountainView WHERE DISTANCEINMILES > 70                           LIMIT 3;",
        "SELECT * FROM ridersNearMountainView WHERE DISTANCEINMILES < 100                          LIMIT 3;",
        "SELECT * FROM ridersNearMountainView WHERE DISTANCEINMILES > 70 AND DISTANCEINMILES < 140 LIMIT 2;"
      ],
      "topics": [
        {"name": "test_topic", "partitions": 1} // to get a stable ordering
      ],
      "inputs": [
        {"topic": "test_topic", "timestamp": 1000001, "key": "which", "value": {"latitude": 37.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000002, "key": "there", "value": {"latitude": 37.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000003, "key": "their", "value": {"latitude": 37.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000004, "key": "about", "value": {"latitude": 37.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000005, "key": "would", "value": {"latitude": 37.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000006, "key": "these", "value": {"latitude": 37.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000007, "key": "other", "value": {"latitude": 38.7877, "longitude": -122.4205}},
        {"topic": "test_topic", "timestamp": 1000008, "key": "words", "value": {"latitude": 38.3903, "longitude": -122.0643}},
        {"topic": "test_topic", "timestamp": 1000009, "key": "could", "value": {"latitude": 38.3952, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000010, "key": "write", "value": {"latitude": 38.3944, "longitude": -122.0813}},
        {"topic": "test_topic", "timestamp": 1000011, "key": "first", "value": {"latitude": 38.4049, "longitude": -122.0822}},
        {"topic": "test_topic", "timestamp": 1000012, "key": "water", "value": {"latitude": 38.7857, "longitude": -122.4011}},
        {"topic": "test_topic", "timestamp": 1000013, "key": "after", "value": {"latitude": 37.7877, "longitude": -123.4205}},
        {"topic": "test_topic", "timestamp": 1000014, "key": "where", "value": {"latitude": 37.3903, "longitude": -123.0643}},
        {"topic": "test_topic", "timestamp": 1000015, "key": "right", "value": {"latitude": 37.3952, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000016, "key": "think", "value": {"latitude": 37.3944, "longitude": -123.0813}},
        {"topic": "test_topic", "timestamp": 1000017, "key": "three", "value": {"latitude": 37.4049, "longitude": -123.0822}},
        {"topic": "test_topic", "timestamp": 1000018, "key": "years", "value": {"latitude": 37.7857, "longitude": -123.4011}}
      ],
      "responses": [
        {"admin": {"@type": "currentStatus"}},
        {"admin": {"@type": "currentStatus"}},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}},
          {"row": {"columns": [90.0 , ["right", "think", "three"]         , 3]}},
          {"row": {"columns": [110.0, ["words", "could", "write", "first"], 4]}},
          {"row": {"columns": [120.0, ["after", "years"]                  , 2]}},
          {"row": {"columns": [150.0, ["water"]                           , 1]}},
          {"row": {"columns": [160.0, ["other"]                           , 1]}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [0.0  , ["their", "about", "would"]         , 3]}},
          {"row": {"columns": [10.0 , ["there"]                           , 1]}},
          {"row": {"columns": [50.0 , ["which", "these"]                  , 2]}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}},
          {"row": {"columns": [90.0 , ["right", "think", "three"]         , 3]}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}},
          {"row": {"columns": [90.0 , ["right", "think", "three"]         , 3]}},
          {"row": {"columns": [110.0, ["words", "could", "write", "first"], 4]}},
          {"row": {"columns": [120.0, ["after", "years"]                  , 2]}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}},
          {"row": {"columns": [110.0, ["words", "could", "write", "first"], 4]}},
          {"row": {"columns": [120.0, ["after", "years"]                  , 2]}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [0.0  , ["their", "about", "would"]         , 3]}},
          {"row": {"columns": [50.0 , ["which", "these"]                  , 2]}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}}
        ]},
        {"query": [
          {"header":{"schema":"`DISTANCEINMILES` DOUBLE KEY, `RIDERS` ARRAY<STRING>, `COUNT` BIGINT"}},
          {"row": {"columns": [80.0 , ["where"]                           , 1]}},
          {"row": {"columns": [110.0, ["words", "could", "write", "first"], 4]}}
        ]}
      ]
    }
  ]
}